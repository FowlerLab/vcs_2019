ggplot(to_plot, aes(x = expected.prop.miRFP, y = value, color = variable)) + geom_point(alpha = 0.5) + stat_summary(geom = 'line', aes(x = expected.prop.miRFP, y = value, group = variable), fun.y = mean, size = 1) + stat_summary(fun.data = 'mean_cl_boot', aes(x = expected.prop.miRFP, y = value, group = variable), size = 0.5) + scale_y_continuous(labels = scales::percent_format(accuracy = 0.1), limits = c(0.5,1)) + scale_color_manual(values = c('#d7191c', '#2c7bb6')) + ylab('Value') + xlab('Percent Target (miRFP Positive) Cells in Population') + scale_x_continuous(labels = scales::percent_format(accuracy = 1)) + guides(color = FALSE)+theme(element_text(size=10)
)
ggplot(to_plot, aes(x = expected.prop.miRFP, y = value, color = variable)) + geom_point(alpha = 0.5) + stat_summary(geom = 'line', aes(x = expected.prop.miRFP, y = value, group = variable), fun.y = mean, size = 1) + stat_summary(fun.data = 'mean_cl_boot', aes(x = expected.prop.miRFP, y = value, group = variable), size = 0.5) + scale_y_continuous(labels = scales::percent_format(accuracy = 0.1), limits = c(0.5,1)) + scale_color_manual(values = c('#d7191c', '#2c7bb6')) + ylab('Value') + xlab('Percent Target (miRFP Positive) Cells in Population') + scale_x_continuous(labels = scales::percent_format(accuracy = 1)) + guides(color = FALSE) + theme(element_text(size=10))
ggplot(to_plot, aes(x = expected.prop.miRFP, y = value, color = variable)) + geom_point(alpha = 0.5) + stat_summary(geom = 'line', aes(x = expected.prop.miRFP, y = value, group = variable), fun.y = mean, size = 1) + stat_summary(fun.data = 'mean_cl_boot', aes(x = expected.prop.miRFP, y = value, group = variable), size = 0.5) + scale_y_continuous(labels = scales::percent_format(accuracy = 0.1), limits = c(0.5,1)) + scale_color_manual(values = c('#d7191c', '#2c7bb6')) + ylab('Value') + xlab('Percent Target (miRFP Positive) Cells in Population') + scale_x_continuous(labels = scales::percent_format(accuracy = 1)) + guides(color = FALSE) + theme(axis.text=element_text(size=10))
ggplot(to_plot, aes(x = expected.prop.miRFP, y = value, color = variable)) + geom_point(alpha = 0.5) + stat_summary(geom = 'line', aes(x = expected.prop.miRFP, y = value, group = variable), fun.y = mean, size = 1) + stat_summary(fun.data = 'mean_cl_boot', aes(x = expected.prop.miRFP, y = value, group = variable), size = 0.5) + scale_y_continuous(labels = scales::percent_format(accuracy = 0.1), limits = c(0.5,1)) + scale_color_manual(values = c('#d7191c', '#2c7bb6')) + ylab('Value') + xlab('Percent Target (miRFP Positive) Cells in Population') + scale_x_continuous(labels = scales::percent_format(accuracy = 1)) + guides(color = FALSE) + theme(axis.text=element_text(size=20))
ggplot(to_plot, aes(x = expected.prop.miRFP, y = value, color = variable)) + geom_point(alpha = 0.5) + stat_summary(geom = 'line', aes(x = expected.prop.miRFP, y = value, group = variable), fun.y = mean, size = 1) + stat_summary(fun.data = 'mean_cl_boot', aes(x = expected.prop.miRFP, y = value, group = variable), size = 0.5) + scale_y_continuous(labels = scales::percent_format(accuracy = 0.1), limits = c(0.5,1)) + scale_color_manual(values = c('#d7191c', '#2c7bb6')) + ylab('Value') + xlab('Percent Target (miRFP Positive) Cells in Population') + scale_x_continuous(labels = scales::percent_format(accuracy = 1)) + guides(color = FALSE) + theme(axis.text=element_text(size=14))
ggsave('sens_precision_miRFP_1C.png', width = 4, height = 2, dpi = 900)
ggplot(to_plot, aes(x = expected.prop.miRFP, y = value, color = variable)) + geom_point(alpha = 0.5) + stat_summary(geom = 'line', aes(x = expected.prop.miRFP, y = value, group = variable), fun.y = mean, size = 1) + stat_summary(fun.data = 'mean_cl_boot', aes(x = expected.prop.miRFP, y = value, group = variable), size = 0.5) + scale_y_continuous(labels = scales::percent_format(accuracy = 0.1), limits = c(0.5,1)) + scale_color_manual(values = c('#d7191c', '#2c7bb6')) + ylab('Value') + xlab('Percent Target (miRFP Positive) Cells in Population') + scale_x_continuous(labels = scales::percent_format(accuracy = 1)) + guides(color = FALSE) + theme(axis.text=element_text(size=14), legend.text=element_text(size=18))
ggplot(to_plot, aes(x = expected.prop.miRFP, y = value, color = variable)) + geom_point(alpha = 0.5) + stat_summary(geom = 'line', aes(x = expected.prop.miRFP, y = value, group = variable), fun.y = mean, size = 1) + stat_summary(fun.data = 'mean_cl_boot', aes(x = expected.prop.miRFP, y = value, group = variable), size = 0.5) + scale_y_continuous(labels = scales::percent_format(accuracy = 0.1), limits = c(0.5,1)) + scale_color_manual(values = c('#d7191c', '#2c7bb6')) + ylab('Value') + xlab('Percent Target (miRFP Positive) Cells in Population') + scale_x_continuous(labels = scales::percent_format(accuracy = 1)) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.legend=element_text(size=18))
ggplot(to_plot, aes(x = expected.prop.miRFP, y = value, color = variable)) + geom_point(alpha = 0.5) + stat_summary(geom = 'line', aes(x = expected.prop.miRFP, y = value, group = variable), fun.y = mean, size = 1) + stat_summary(fun.data = 'mean_cl_boot', aes(x = expected.prop.miRFP, y = value, group = variable), size = 0.5) + scale_y_continuous(labels = scales::percent_format(accuracy = 0.1), limits = c(0.5,1)) + scale_color_manual(values = c('#d7191c', '#2c7bb6')) + ylab('Value') + xlab('Percent Target (miRFP Positive) Cells in Population') + scale_x_continuous(labels = scales::percent_format(accuracy = 1)) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
ggsave('sens_precision_miRFP_1C.png', width = 4, height = 2, dpi = 900)
ggplot(to_plot, aes(x = expected.prop.miRFP, y = value, color = variable)) + geom_point(alpha = 0.5) + stat_summary(geom = 'line', aes(x = expected.prop.miRFP, y = value, group = variable), fun.y = mean, size = 1) + stat_summary(fun.data = 'mean_cl_boot', aes(x = expected.prop.miRFP, y = value, group = variable), size = 0.5) + scale_y_continuous(labels = scales::percent_format(accuracy = 0.1), limits = c(0.5,1)) + scale_color_manual(values = c('#d7191c', '#2c7bb6')) + ylab('Value') + xlab('Percent Target (miRFP Positive)\nCells in Population') + scale_x_continuous(labels = scales::percent_format(accuracy = 1)) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
ggsave('sens_precision_miRFP_1C.png', width = 4, height = 2, dpi = 900)
ggplot(to_plot, aes(x = expected.prop.miRFP, y = value, color = variable)) + geom_point(alpha = 0.5) + stat_summary(geom = 'line', aes(x = expected.prop.miRFP, y = value, group = variable), fun.y = mean, size = 1) + stat_summary(fun.data = 'mean_cl_boot', aes(x = expected.prop.miRFP, y = value, group = variable), size = 0.5) + scale_y_continuous(labels = scales::percent_format(accuracy = 0.1), limits = c(0.5,1)) + scale_color_manual(values = c('#d7191c', '#2c7bb6')) + ylab('Value') + xlab('Percent Target\nCells in Population') + scale_x_continuous(labels = scales::percent_format(accuracy = 1)) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
ggsave('sens_precision_miRFP_1C.png', width = 4, height = 2, dpi = 900)
ggsave('sens_precision_miRFP_1C.png', width = 4, height = 3, dpi = 900)
# plot ROC curves
# collect names of all data in directory and remove .fcs from files
file_list = list.files(path = '.', pattern = '.fcs')
file_list_nofcs <- unlist(strsplit(file_list, split = '.fcs'))
metadat <- data.frame(file_list_nofcs, c(T, T, T, T, T, T, T, T, T, T, T, T, T, F, F, F, F, F, F, F, F, F, F, F), factor(c(10, 50, 0.4, 0.4, 2, 10, 50, 2, 0.4, 50, 10, 2, 0.4, 100, 100, 50, 10, 2, 0.4, 50, 0.4, 0.4, 0, 50)), stringsAsFactors = FALSE)
colnames(metadat) <- c('sample', 'activated', 'expected.prop.miRFP')
i <- 1
AUC_values = c()
prop_miRFPpos = c()
sens = c()
spec = c()
precision = c()
fpr = c()
plot_data = list()
plot_data = lapply(file_list, function(file) {
# prep plot list
plots = list()
# convert data name to file
data_name = strsplit(file, split = '.fcs')
# read data
x = read.FCS(paste0(data_name, '.fcs'), transformation=FALSE, alter.names=TRUE)
## gate out trash
x.notrash <- gate_trash(x, FSCA_cutoff = 25000, SSCA_cutoff = 25000)
# filter for live cell and plot
x.live = Subset(x.notrash, filter(x.notrash, live))
# filter for single cell
x.single = Subset(x.live, filter(x.live, single))
# extract data and calculate PE/FITC ratio
x.live.single <- calc.ratio.extract.data(x.single)
# remove rows with data at the minimum value for PE.A, FITC.A
x.live.single <- x.live.single[which(x.live.single[,'PE.A.log'] != min(x.live.single[,'PE.A.log'])),]
x.live.single <- x.live.single[which(x.live.single[,'FITC.A.log'] != min(x.live.single[,'FITC.A.log'])),]
# filter for FITC positive cells
x.live.single.FITCpos<-x.live.single[which(x.live.single[,'FITC.A.log'] > FITC.gate),]
plots[[length(plots) + 1]] = ggplot(x.live.single, aes(x = FITC.A.log)) + geom_histogram(bins = 75) + geom_vline(xintercept = FITC.gate, linetype = 'dashed', size = 1)
# calculate the actual % positive miRFP cells
prop_miRFPpos[i] <<- length(which(x.live.single.FITCpos$A700.A.log > A700_gate))/length(x.live.single.FITCpos$A700.A.log)
# calculate the sensitivity and specificity at baseline
sens.spec.data <- sens.spec(x.live.single.FITCpos, A700_gate, actunact.gate)
sens[i] <<- sens.spec.data$sens
spec[i] <<- sens.spec.data$spec
fpr[i] <<- sens.spec.data$fpr
precision[i] <<- sens.spec.data$precision
# calculate ROC and AUC
quants_poscells = quantile(x.live.single.FITCpos[which(x.live.single.FITCpos$act.unact > actunact.gate),]$act.unact, probs = seq(0, 1, 0.01), names = FALSE)
quants_poscells = quantile(x.live.single.FITCpos$act.unact, probs = seq(0, 1, 0.01), names = FALSE)
quants_poscells = data.frame(seq(0, 1, 0.01), quants_poscells)
colnames(quants_poscells) = c('percentile','cutoff')
ROCdata <- cbind(quants_poscells, as.data.frame(t(as.data.frame(sapply(quants_poscells$cutoff, sens.spec, x = x.live.single.FITCpos, A700.gate = A700_gate)))))
ROCdata$sens = unlist(ROCdata$sens)
ROCdata$spec = unlist(ROCdata$spec)
ROCdata$precision = unlist(ROCdata$precision)
ROCdata$fpr = unlist(ROCdata$fpr)
ROCdata <- ROCdata[order(ROCdata$sens),]
plots[[length(plots) + 1]] = ggplot(ROCdata, aes(x = (1 - precision), y= sens)) + geom_point() + geom_line()
xAUC = 1 - (ROCdata$precision)
yAUC = ROCdata$sens
AUC_values[i] <<- AUC(xAUC[which(!is.na(xAUC))], yAUC[which(!is.na(xAUC))], method = c("spline"))
# plot 2D plot of PE.A vs. FITC
plots[[length(plots) + 1]] = ggplot(x.live.single.FITCpos, aes(x=FITC.A.log, y=PE.A.log)) + geom_hex(bins = 50) + scale_fill_distiller(palette = 'Spectral')
# plot 1D plot of act.unact
plots[[length(plots) + 1]] = ggplot(x.live.single.FITCpos, aes(x = act.unact)) + geom_histogram(bins = 75) + geom_vline(xintercept = actunact.gate, linetype = 'dashed')
# plot the 2D hexbin of act.unact vs. A.700.A.log
plots[[length(plots) + 1]] = ggplot(x.live.single.FITCpos, aes(x=act.unact, y=A700.A.log)) + geom_hex(bins = 50) + scale_fill_distiller(palette = 'Spectral') + hexbin_cutoff_label(x.live.single.FITCpos, 'act.unact', actunact.gate, 'A700.A.log', A700_gate) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed')
# plot the 2D hexbin showing all bins with 1 cell in it as grey
plots[[length(plots) + 1]] = ggplot(x.live.single.FITCpos, aes(x=act.unact, y=A700.A.log)) + geom_hex(bins = 50) + scale_fill_distiller(palette = 'Spectral', limits = c(2,350)) + hexbin_cutoff_label(x.live.single.FITCpos, 'act.unact', actunact.gate, 'A700.A.log', A700_gate) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed')
# place plots into directory in a single pdf
pdf_name = paste0(data_name, '_plots.pdf')
pdf(pdf_name, onefile = TRUE)
grid.arrange(grobs=plots, ncol=2, top=str(data_name))
dev.off()
i <<- i +1
# return plotting data
plot_data[data_name[[1]]] = x.live.single.FITCpos
# return the AUC curve
return(x.live.single.FITCpos)
})
metadat <- cbind(metadat, prop_miRFPpos, AUC_values, spec, sens, fpr, precision)
metadat$expected.prop.miRFP <- as.factor(metadat$expected.prop.miRFP)
write.csv(metadat, 'miRFPenrich_metadat_09-18-17.csv', row.names = FALSE)
saveRDS(plot_data, 'plotdata_miRFPenrichment.RDS')
flow_plot_data = readRDS('plotdata_miRFPenrichment.RDS')
head(metadat)
tail(metadat)
tail(metadat, 20)
# take two 10% datasets
datasets = flow_plot_data[which(metadat$sample %in% c('U2OS C11 unactivated_A03_005', 'U2OS activated_C04_018')),]
# take two 10% datasets
datasets = flow_plot_data[which(metadat$sample %in% c('U2OS C11 unactivated_A03_005', 'U2OS activated_C04_018'))]
head(datasets[[1]])
# merge the datasets together
datasets[[1]]$activated = T
datsets[[2]]$activated = F
# merge the datasets together
datasets[[1]]$activated = T
datasets[[2]]$activated = F
datasets = bind_rows(datasets)
datasets = rbind(datasets)
head(datasets)
# take two 10% datasets
datasets = flow_plot_data[which(metadat$sample %in% c('U2OS C11 unactivated_A03_005', 'U2OS activated_C04_018'))]
# merge the datasets together
datasets[[1]]$activated = T
datasets[[2]]$activated = F
datasets = bind_rows(datasets)
library(dplyr)
datasets = bind_rows(datasets)
head(datasets)
View(sens.spec.data)
View(plots)
View(live)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_point(alpha = 0.1) + geom_density_2d() + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d() + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d(n=200) + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d(linemitre = 5) + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d(aes(linemitre = 5)) + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d(linemitre = 100) + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d(linemitre = 1) + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d(linemitre = 1, n = 100) + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d(breaks = 1e-6(seq(0,10,by=2))) + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d(breaks = 1e-6(seq(0,10,by=2)),geom='contour') + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_contour() + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d(levels = 10) + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d(bins = 10) + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d(bins = 100) + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d(bins = 50) + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_hexbin() + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_hex() + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated))  + geom_density_2d(bins = 50) + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated)) + geom_point(alpha = 0.05) + geom_density_2d(bins = 50) + scale_color_manual(values = c('#4dac26', '#d01c8b')) + ylab('Log miRFP Intensity') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
View(x)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, color = activated)) + scale_fill_distiller(palette = 'Spectral', limits = c(2,350)) + hexbin_cutoff_label(x.live.single.FITCpos, 'act.unact', actunact.gate, 'A700.A.log', A700_gate) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, fill = activated)) + scale_fill_distiller(palette = 'Spectral', limits = c(2,350)) + hexbin_cutoff_label(x.live.single.FITCpos, 'act.unact', actunact.gate, 'A700.A.log', A700_gate) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log, fill = activated)) + scale_fill_distiller(palette = 'Spectral', limits = c(2,350)) + hexbin_cutoff_label(x.live.single.FITCpos, 'act.unact', actunact.gate, 'A700.A.log', A700_gate) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') #+facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + scale_fill_distiller(palette = 'Spectral', limits = c(2,350)) + hexbin_cutoff_label(x.live.single.FITCpos, 'act.unact', actunact.gate, 'A700.A.log', A700_gate) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + scale_fill_distiller(palette = 'Spectral', limits = c(2,350)) + hexbin_cutoff_label(datasets, 'act.unact', actunact.gate, 'A700.A.log', A700_gate) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + scale_fill_distiller(palette = 'Spectral', limits = c(2,350)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex() + scale_fill_distiller(palette = 'Spectral', limits = c(2,350)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex() + scale_fill_distiller(palette = 'Spectral', limits = c(2,400)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex() + scale_fill_distiller(palette = 'Spectral', limits = c(2,500)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex() + scale_fill_distiller(palette = 'Spectral', limits = c(2,1000)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex() + scale_fill_distiller(palette = 'Spectral', limits = c(2,800)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex() + scale_fill_distiller(palette = 'Spectral', limits = c(2,850)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex() + scale_fill_distiller(palette = 'Spectral', limits = c(2,900)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18))
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex() + scale_fill_distiller(palette = 'Spectral', limits = c(2,900)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank()
)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(color = 'black') + scale_fill_distiller(palette = 'Spectral', limits = c(2,900)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank()
)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(color = 'black') + scale_fill_distiller(limits = c(2,900)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank()
)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black') + scale_fill_distiller(limits = c(2,900)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank()
)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black') + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank()
)
ggsave('sens_precision_miRFP_1B.png', width = 4, height = 3, dpi = 900)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank()
)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank() + guides(fill = FALSE)
)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank()) + guides(fill = FALSE)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 0.5)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 0.5)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.25)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.8)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.6)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 0.6)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 0.8)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.background = element_blank(), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
# take two 10% datasets
datasets = flow_plot_data[which(metadat$sample %in% c('U2OS C11 unactivated_A03_005', 'U2OS activated_C04_018'))]
# merge the datasets together
datasets[[1]]$activated = 'Photoswitched'
datasets[[2]]$activated = 'Negative Control'
datasets = bind_rows(datasets)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab('miRFP Intensity (Log10)') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab('miRFP Intensity (Log["10"])') +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(expression('miRFP Intensity (Log["10"])')) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(expression(Blah[1*d]*"%")) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(expression(Log["10"] miRFP Expression)) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(paste0(expression(Log["10"]), ' miRFP Expression')) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(paste0(expression(Log[10]), ' miRFP Expression')) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(expression(Log["10"])*miRFP*Expression)) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(expression(Log["10"]*miRFP*Expression)) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(expression(Log["10"]*" "*miRFP*Expression)) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(expression(Log["10"]*" "*miRFP*" "*Expression)) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(expression(Log["10"]*" "*miRFP*"\n"*Expression)) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(expression(Log["10"]*" "*miRFP*"/n"*Expression)) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(expression(Log["10"]*" "*miRFP\nExpression)) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(expression(Log["10"]*" "*miRFP"\n"Expression)) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(expression(Log["10"]*" "*miRFP,Expression)) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ylablist = list(expression(Log["10"]*" "*miRFP), expression(Expression))
# plot the datasets
ylablist = list(expression(Log["10"]*" "*miRFP), expression(Expression))
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(do.call(expression, ylablist)) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ylablist = list(expression(paste(Log["10"]*" "*miRFP, "Expression")))
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(ylablist) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ylablist = expression(paste(Log["10"]*" "*miRFP, "Expression"))
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(ylablist) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ylablist = expression(paste(Log["10"]*" "*miRFP, "\nExpression"))
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(ylablist) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ylablist = expression(paste(Log["10"]*" "*miRFP, "\nExpression"))
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(ylablist) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ylablist = as.list(expression(paste(Log["10"]*" "*miRFP, "\nExpression")))
ylablist
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(ylablist) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ylablist = expression(paste(Log["10"]*" "*miRFP, "Expression"))
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(ylablist) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ylablist = expression(paste(Log["10"]*" "*miRFP, "\nExpression"))
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(ylablist) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ylablist = expression(paste(Log["10"]*" "*miRFP, Expression))
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(ylablist) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ylablist = as.list(expression(paste(Log["10"]*" "*miRFP, Expression)))
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(ylablist) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
# plot the datasets
ylablist = atop(Log["10"]*" "*miRFP,Expression)
# plot the datasets
ylablist = expression(atop(Log["10"]*" "*miRFP,Expression))
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(ylablist) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
datasets[[2]]$activated = 'Negative\nControl'
# take two 10% datasets
datasets = flow_plot_data[which(metadat$sample %in% c('U2OS C11 unactivated_A03_005', 'U2OS activated_C04_018'))]
# merge the datasets together
datasets[[1]]$activated = 'Photoswitched'
datasets[[2]]$activated = 'Negative\nControl'
datasets = bind_rows(datasets)
# plot the datasets
ylablist = expression(atop(Log["10"]*" "*miRFP,Expression))
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(ylablist) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 18), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) + geom_hex(bins = 50, color = 'black', size = 0.1) + scale_fill_distiller(limits = c(2,450)) + geom_hline(yintercept = A700_gate, linetype = 'dashed') + geom_vline(xintercept = actunact.gate, linetype = 'dashed') + xlab('Activation Ratio') + ylab(ylablist) +facet_wrap(~activated, ncol = 2) + guides(color = FALSE) + theme(axis.text=element_text(size=14), axis.title=element_text(size=18), strip.text.x = element_text(size = 16), strip.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) + guides(fill = FALSE)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) +
geom_hex(bins = 50, color = 'black', size = 0.1) +
scale_fill_distiller(limits = c(2,450)) +
geom_hline(yintercept = A700_gate, linetype = 'dashed') +
geom_vline(xintercept = actunact.gate, linetype = 'dashed') +
xlab('Activation Ratio') + ylab(ylablist) +
facet_wrap(~activated, ncol = 2) +
guides(color = FALSE) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=18),
strip.text.x = element_text(size = 16),
strip.background = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
legend.position = "bottom")
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) +
geom_hex(bins = 50, color = 'black', size = 0.1) +
scale_fill_distiller(limits = c(2,450)) +
geom_hline(yintercept = A700_gate, linetype = 'dashed') +
geom_vline(xintercept = actunact.gate, linetype = 'dashed') +
xlab('Activation Ratio') + ylab(ylablist) +
facet_wrap(~activated, ncol = 2) +
guides(color = FALSE) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=18),
strip.text.x = element_text(size = 16),
strip.background = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
legend.position = "bottom",
legend.box.background = element_rect(colour = "black"))
# get the labels for percentages
datasets$activated = F
datasets[which(datasets$act.unact > actunact.gate),'activated'] = T
datasets$miRFPpos = F
datasets[which(datasets$A700.A.log > A700_gate),'miRFPos'] = T
# take two 10% datasets
datasets = flow_plot_data[which(metadat$sample %in% c('U2OS C11 unactivated_A03_005', 'U2OS activated_C04_018'))]
# merge the datasets together
datasets[[1]]$label = 'Photoswitched'
datasets[[2]]$label = 'Negative\nControl'
datasets = bind_rows(datasets)
# get the labels for percentages
datasets$activated = F
datasets[which(datasets$act.unact > actunact.gate),'activated'] = T
datasets$miRFPpos = F
datasets[which(datasets$A700.A.log > A700_gate),'miRFPpos'] = T
table(datasets, c(activated,miRFPpos,label))
table(datasets, c('activated','miRFPpos','label'))
?table
table(datasets[,c('activated','miRFPpos','label')])
table(datasets[,c('activated','miRFPpos','label')])[[1]]
table = table(datasets[,c('activated','miRFPpos','label')])
table
table(datasets[which(datasets$label == 'Negative\nControl'),c(,'miRFPpos','activated')])
datasets[which(datasets$label == 'Negative\nControl'),c(,'miRFPpos','activated')]
table(datasets[which(datasets$label == 'Negative\nControl'),c('miRFPpos','activated')])
table(datasets[which(datasets$label == 'Negative\nControl'),c('miRFPpos','activated')])/sum((datasets$label == 'Negative\nControl'))
table(datasets[which(datasets$label == 'Photoswitched'),c('miRFPpos','activated')])/sum((datasets$label == 'Photoswitched'))
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) +
geom_hex(bins = 50, color = 'black', size = 0.1) +
scale_fill_distiller(limits = c(2,450)) +
geom_hline(yintercept = A700_gate, linetype = 'dashed', size = 0.5) +
geom_vline(xintercept = actunact.gate, linetype = 'dashed', size = 0.5) +
xlab('Activation Ratio') + ylab(ylablist) +
facet_wrap(~label, ncol = 2) +
guides(color = FALSE) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=18),
strip.text.x = element_text(size = 16),
strip.background = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
legend.position = "bottom",
legend.box.background = element_rect(color = "black"))
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) +
geom_hex(bins = 50, color = 'black', size = 0.1) +
scale_fill_distiller(limits = c(2,450)) +
geom_hline(yintercept = A700_gate, linetype = 'dashed', size = 0.5) +
geom_vline(xintercept = actunact.gate, linetype = 'dashed', size = 0.5) +
xlab('Activation Ratio') + ylab(ylablist) +
facet_wrap(~label, ncol = 2) +
guides(color = FALSE) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=18),
strip.text.x = element_text(size = 16),
strip.background = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) +
geom_hex(bins = 50, color = 'black', size = 0.1) +
scale_fill_distiller(limits = c(2,450)) +
geom_hline(yintercept = A700_gate, linetype = 'dashed', size = 0.5) +
geom_vline(xintercept = actunact.gate, linetype = 'dashed', size = 0.5) +
xlab('Activation Ratio') + ylab(ylablist) +
facet_wrap(~label, ncol = 2) +
guides(color = FALSE) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=18),
strip.text.x = element_text(size = 16),
strip.background = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
guides(fill = FALSE)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) +
geom_hex(bins = 50, color = 'black', size = 0.1) +
scale_fill_distiller(limits = c(2,450)) +
geom_hline(yintercept = A700_gate, linetype = 'dashed', size = 0.2) +
geom_vline(xintercept = actunact.gate, linetype = 'dashed', size = 0.2) +
xlab('Activation Ratio') + ylab(ylablist) +
facet_wrap(~label, ncol = 2) +
guides(color = FALSE) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=18),
strip.text.x = element_text(size = 16),
strip.background = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
guides(fill = FALSE)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) +
geom_hex(bins = 50, color = 'black', size = 0.5) +
scale_fill_distiller(limits = c(2,450)) +
geom_hline(yintercept = A700_gate, linetype = 'dashed', size = 0.5) +
geom_vline(xintercept = actunact.gate, linetype = 'dashed', size = 0.2) +
xlab('Activation Ratio') + ylab(ylablist) +
facet_wrap(~label, ncol = 2) +
guides(color = FALSE) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=18),
strip.text.x = element_text(size = 16),
strip.background = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
guides(fill = FALSE)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) +
geom_hex(bins = 50, color = 'black', size = 0.1) +
scale_fill_distiller(limits = c(2,450)) +
geom_hline(yintercept = A700_gate, linetype = 'dashed', size = 0.5) +
geom_vline(xintercept = actunact.gate, linetype = 'dashed', size = 0.5) +
xlab('Activation Ratio') + ylab(ylablist) +
facet_wrap(~label, ncol = 2) +
guides(color = FALSE) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=18),
strip.text.x = element_text(size = 16),
strip.background = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
guides(fill = FALSE)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
ggplot(datasets, aes(x = act.unact, y = A700.A.log)) +
geom_hex(bins = 50, color = 'black', size = 0.1) +
scale_fill_distiller(limits = c(2,450)) +
geom_hline(yintercept = A700_gate, linetype = 'dashed', size = 0.3) +
geom_vline(xintercept = actunact.gate, linetype = 'dashed', size = 0.3) +
xlab('Activation Ratio') + ylab(ylablist) +
facet_wrap(~label, ncol = 2) +
guides(color = FALSE) +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=18),
strip.text.x = element_text(size = 16),
strip.background = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
guides(fill = FALSE)
ggsave('miRFP_enrichment_1B.png', width = 4, height = 3, dpi = 900)
# calculate average precision
mean(metadat[which(metadat$activated == T),'precision'])
mean(metadat[which(metadat$activated == T),'sens'])
